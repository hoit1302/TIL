# Convolutional Neural Network

## Fully Connected Layer

![image](https://user-images.githubusercontent.com/68107000/164577317-db6572c3-3821-46a4-96f5-4ed0263fe750.png)

## Convolutional Neural Network

- ì´ë¯¸ì§€(2D spatial data) ì¸ì‹ê³¼ ë¶„ë¥˜ì— ì¢‹ìŒ

- not FC â†’ less weights, less computation

- FCë³´ë‹¤ íš¨ê³¼ì ìœ¼ë¡œ feature extraction

## ImageNet Competition

- ImageNet(ë°ì´í„°ì…‹ ì´ë¦„) Large Scale Visual Recognition Challenge (ILSVRC)

- ~14 million images, 1000ê°œì˜ classes

- top 5 error (5ê°œ ìƒìœ„ classì— ìˆìœ¼ë©´ O)

- CNNs made a big breakthrough in the challenge

## 2D Convolution

- input image, input activation, input feature map

- convolution operator

- Filter, Kernel, Weight

- Output image, Output activation, Output feature map

![image](https://user-images.githubusercontent.com/68107000/164578901-0a684b21-ec2a-4ad7-b1e0-2b32cc7e21dc.png)

## Zero Pad

![image](https://user-images.githubusercontent.com/68107000/164579693-565d826e-9124-46a8-be55-a7bd628917e1.png)

sizeë¥¼ ìœ ì§€ì‹œì¼œì£¼ê¸° ìœ„í•œ ê¸°ë²•

ê´€í–‰ì ìœ¼ë¡œ ê°€ì¥ìë¦¬ì— zero padë¥¼ í•˜ëŠ” ê±´ í”í•˜ë‹¤.

## Interpretation(ì´í•´) of Convolution

### edge ì°¾ê¸°

![image](https://user-images.githubusercontent.com/68107000/164580670-4b690639-705c-4159-8eb2-9adad14995c8.png)

- ë‹¤ì–‘í•œ convolution kernel ì¤‘ì— ìœ„ì™€ ê°™ì€ ì»¤ë„ì€ edge detectorì˜ ì—­í• ì„ í•œë‹¤. 

- edge featureë¥¼ extractí•˜ëŠ” ì—­í• ì„ í•œë‹¤.

- convolution kernelê³¼ ë¹„ìŠ·í•œ ì–‘ìƒì„ ê°€ì§€ëŠ” input pixelì€ ë” í° ë°˜ì‘ì„ ë³´ì¸ë‹¤. ê°’ì´ ì»¤ì„œ í°ìƒ‰ìœ¼ë¡œ ë³´ì¸ë‹¤. ë³€í™”ëŸ‰ ìˆëŠ” ë¶€ë¶„ì€ edgeì— í•´ë‹¹í•œë‹¤.
  
  ```
  ì½” ë¶€ë¶„
  1 1 0   -1 -1 -1
  1 1 0 * -1  8 -1 = (-1) * 5 + 8 = 3
  1 1 0   -1 -1 -1
  ```

- ë³€í™”ê°€ ì—†ëŠ” ê³³(edgeì•„ë‹˜)ì€ ë°˜ì‘ì´ ê±°ì˜ ì—†ë‹¤. ê°’ì´ ì‘ì•„ì„œ ê²€ì€ìƒ‰ìœ¼ë¡œ ë³´ì¸ë‹¤.
  
  ```
  ë°°ê²½ ë¶€ë¶„
  1 1 1   -1 -1 -1
  1 1 1 * -1  8 -1 = (-1) * 8 + 8 = 0
  1 1 1   -1 -1 -1
  ```

### face ì°¾ê¸°

![image](https://user-images.githubusercontent.com/68107000/164580771-acd1661f-14e6-4a94-ba5d-cbd264c685ba.png)

- filterê°€ ì–¼êµ´ì„ 180Â° íšŒì „í•œ ëª¨ìŠµì´ë‹¤. (ëˆˆì½”ë¥¼ ì°¾ì„ ìˆ˜ ìˆë„ë¡ ìˆ˜í•™ì ìœ¼ë¡œ ì •ë°€íˆ ì‚°ì¶œëœ í•„í„°ì„)

- ëˆˆì½”ì™€ ë¹„ìŠ·í•˜ë©´ cross-correlate(ìƒí˜¸ ë¹„êµ) â†‘ â†’ output â†‘ (í•˜ì–—ê²Œ í‘œì‹œ! ì ê°™ì€ ë¶€ë¶„)

- ë¹„ìŠ·í•˜ì§€ ì•Šìœ¼ë©´ cross-correlate(ìƒí˜¸ ë¹„êµ) â†“ â†’ output â†“ (ê¹Œë§£ê²Œ í‘œì‹œ)

---

ê³¼ê±° computer visionì€ conv kernel (eg. edge detector filter, face detector)ì„ ì‚¬ëŒì´ ì°¾ì•˜ë‹¤. 

ì§€ê¸ˆì€ ì»¤ë„ì„ ê¸°ê³„ê°€ ì°¾ì•„ì¤€ë‹¤!

## 3D Convolution

ì‹¤ì œë¡œëŠ” 3D convë¥¼ ë” ë§ì´ ì“´ë‹¤.

![image](https://user-images.githubusercontent.com/68107000/164582986-0755ec31-5df7-4f40-86c8-ac158416c292.png)

- 3D input feature map (H1 * W1 * input channel(depth))

- 3D filter (F * F * input channel(depth))

- 2D output feature map (H2* W2)

ê° 2ì°¨ì›ë¼ë¦¬(ì±„ë„) ê³±í•˜ê³  ë§ì…ˆí•œ ê²ƒì„ ì¾… ì°ì—ˆë‹¤! (í•©í–ˆë‹¤!) ì´ë™í•˜ë©´ì„œ ê°™ì€ í–‰ë™ì„ í•œë‹¤.

## Output channel

ì‹¤ì œ cnnì—ì„œëŠ” output channelì´ë¼ëŠ” í•œê°€ì§€ dimensionì´ ë” ìƒê¸´ë‹¤. input feature map ë¿ë§Œì•„ë‹ˆë¼ output feature mapë„ 3Dë¡œ ë§Œë“ ë‹¤. ê·¸ëŸ¬ë©´ filterëŠ” 4Dê°€ ëœë‹¤. ì•„ë˜ì˜ êµ¬ì¡°ê°€ ì¼ë°˜ì ì¸ convolution layerì˜ êµ¬ì¡°ê°€ ëœë‹¤.

![image](https://user-images.githubusercontent.com/68107000/164623268-c7b2b0cf-352a-4821-83c5-998feefbb203.png)

- 3D input feature map (H1 * W1 * input channels (í˜¹ì€ depth))

- 4D filter (F * F * input channel(depth), K)

- 3D output feature map (H2* W2 * Output channels(í˜¹ì€ depth) == K)

(ë‚˜ë§Œì˜ ê¸°ì–µë²•) ê° 2ì°¨ì›ë¼ë¦¬ ê³±í•˜ê³  ë”í•œ ê²ƒì„ ì¾… ì¾… ì¾… (3D í•„í„°ì˜ ê°œìˆ˜ë§Œí¼ == K ë‚´ë ¤ê°€ë©´ì„œ) ê·¸ë¦¬ê³  ê°™ì€ í–‰ë™ì„ ì´ë™í•˜ë©´ì„œ.

## Convolutional Layer ìš”ì•½

![image](https://user-images.githubusercontent.com/68107000/164623459-bbe9f33d-118d-4874-ba62-15b2531b8e44.png)

biasëŠ” 3D filterì— í•˜ë‚˜ì”© ì¡´ì¬

## Convolutional Layer in terms of Neurons

**Receptive field**

![image](https://user-images.githubusercontent.com/68107000/164624109-5f3834d9-a56d-440a-af86-64f75f5692d2.png)

## vs. Biological Observation

retina ë§ë§‰ì—ì„œ receptive fieldë¼ëŠ” ì˜ì—­ ë‹¨ìœ„ë¡œ ë¹› ì‹ í˜¸ë¥¼ ì²˜ë¦¬í•œë‹¤. ê·¸ë¦¬ê³  ë§ë§‰ ì„¸í¬ë“¤ì´ hierarchicalí•˜ê²Œ ì¡´ì¬í•´ì„œ ê° receptive fieldê°€ ë‹´ë‹¹í•˜ê³  ê·¸ ë’¤ì— ì¸µì˜ ì„¸í¬ì—ê²Œ ì‹ í˜¸ë¥¼ ë„˜ê²¨ì£¼ëŠ”ë° ì•ìª½ simple cellsëŠ” ë°©í–¥ë§Œ ê°ì§€í•˜ê³  ì ì  ë’¤ë¡œ ê°ˆìˆ˜ë¡ complex cellsë“¤ì€ ë³µì¡í•˜ê²Œ ë°©í–¥ê³¼ ì›€ì§ì„ì„ ì¸ì‹í•˜ê³  hypercomplex cellë“¤ì€ ê¼­ì§“ì ì´ ìˆëŠ” movementë¥¼ ì¸ì‹í•œë‹¤.

## Pooling (Subsampling)

non-linear down-samplingì˜ í˜•ì‹ì´ê¸° ë•Œë¬¸ì— subsampling ì´ë¼ê³ ë„ ë¶€ë¥¸ë‹¤.

- ì¥ì 
  
  - Feature map size reduction
    
    - ì—°ì‚°ëŸ‰ â†“, ìš©ëŸ‰ â†“
    
    - 2 â¨‰ 2 maxpooling with stride 2 í•˜ë©´ feature sizeê°€ Â½ â¨‰ Â½ ì”© ì¤„ì–´ë“¦.
  
  - translation invarianceì— ê°•í•´ì§„ë‹¤.
    
    - ì´ë¯¸ì§€ì— ì‚¬ë¬¼ì´ ì¡´ì¬í•  ë•Œ ì¡°ê¸ˆ ì›€ì§ì—¬ë„ ê°™ì€ ì‚¬ë¬¼ë¡œ ì¸ì‹

## AlexNet

network architecture diagram

![image](https://user-images.githubusercontent.com/68107000/164644610-516ae0ad-44a2-4b85-97c9-dab2f8052150.png)

- ì™œ input channelì´ 3ì¸ê°€? RGB ë¼ì„œ 3

- ì²«ë²ˆì§¸ CONV layerì˜ weight ê°œìˆ˜ëŠ” `F^2 * K * C` = 11^2 * 96 * 3

- ì²«ë²ˆì§¸ CONV layerë¥¼ ê±°ì¹œ í›„ `W2` = `(W1 - F + 2P) / S + 1` = (224 - 11 + 3) / 4 + 1 = 55

- ë‘ë²ˆì§¸ CONV ìˆ˜í–‰í•˜ê³  ReLU activation functionì„ ê±°ì¹œ ë’¤ 3 â¨‰ 3 maxpooling with stride 2 ë¥¼ ìˆ˜í–‰í•´ì„œ 55 â†’ 27 ê±°ì˜ ë°˜ì ˆë¡œ ì¤„ì—ˆë‹¤.
  
  - 27 = (55 - 3) / 2 + 1

- ë‘ë²ˆì§¸ CONV layer weightì˜ ê°œìˆ˜: 5^2 * 96 * 256

- ì„¸ë²ˆì§¸ CONV layer weightì˜ ê°œìˆ˜: 3^2 * 256 * 384

- ë„¤ë²ˆì§¸ CONV layer weightì˜ ê°œìˆ˜: 3^2 * 384 * 384

- ë‹¤ì„¯ë²ˆì§¸ CONV layer weightì˜ ê°œìˆ˜: 5^5 * 384 * 256

- ì²«ë²ˆì§¸ Dense layerì˜ weight ê°œìˆ˜: 7^2 * 256 * 4096
  
  - 13 â¨‰ 13 ì—ì„œ max poolingì„ í†µí•´ 7 â¨‰ 7ì´ ë˜ì—ˆê¸° ë•Œë¬¸

- ë‘ë²ˆì§¸ Dense layerì˜ weight ê°œìˆ˜: 4096 * 4096

- ì„¸ë²ˆì§¸(ë§ˆì§€ë§‰) Dense layerì˜ weight ê°œìˆ˜: 4096 * 1000
  
  - ë§ˆì§€ë§‰ ìˆ˜ëŠ” ImageNet dataset classê°€ 1000ê°œë¼ì„œ

filterì™€ì˜ conv ì—°ì‚° ìì²´ê°€ feature extractionì— í•´ë‹¹í•œë‹¤.

## ì–´ë””ì—ë“  ìˆëŠ” CNN

### AlphaGo

- interpret Go status

- google (ìì²´) TPU chip ì„¤ê³„

- ê·¸ëƒ¥ ì¶”ê°€ë¡œ
  
  - policy network: ë‹¤ìŒ ìˆ˜ì— ëŒ€í•œ ì˜ˆì¸¡
  
  - value network: íŒì„¸ íŒë³„

### Tesla's Autopilot

- front scene recognitionì„ ìœ„í•´

- ì „ë°© ì£¼ì‹œ ì¹´ë©”ë¼ê°€ ì‚¬ë¬¼ ì¸ì‹í•¨.

- ì‹¤ì‹œê°„ì´ ì¤‘ìš”í•¨.

- ìì²´ ê°œë°œ chip

- NPU (neural processing unit): ë”¥ëŸ¬ë‹ ì „ìš© ê°€ì† HW

### Apple Face ID

- ì–¼êµ´ ì¸ì‹

- ë¹ ë¥´ê²Œ ë™ì‘ì‹œí‚¤ê¸° ìœ„í•´ A14 Bionic (NPU)ì´ë‚˜ M1 ê°™ì€ chip ë‚´ì¥

### Samsung Galaxy S21

- photo enhancement

- ìŠ¤ë§ˆíŠ¸í° ì „ìš©ì¹© Exynos 9(9820) ì•ˆì— NPU ì¡´ì¬

ğŸ™ŒğŸ» ë§ì€ ì–‘ì˜ ì—°ì‚°ì„ ìš”êµ¬í•˜ê¸° ì‹œì‘í–ˆë‹¤. HWë„ ì˜ ì•Œê³  ìˆëŠ” SW ê°œë°œìê°€ ë˜ì.
