# 그래프 신경망

그래프는 관계와 상호작용을 묘사하고 분석하기 위한 일반적인 표현이다. 데이터의 많은 종류가 그래프로 표현된다.

현대 딥러닝(CNN, DNN, transformer 등)은 간단한 sequence들과 grid들을 처리하도록 고안되어 있다. 하지만 모든 게 sequence들과 grid들로 표현할 수는 없다.

그래프는 딥러닝의 새로운 지평을 열었다. 가장 각광받는 소분야이다.

하지만 network가 복잡하다. 

- 복잡한 topological 구조이고 크기도 모른다. (arbitrary size)

- 고정된 순서나 좌표가 없다

- 동적이고 (변경 잦음), multimodal 데이터나 feature까지 처리해야한다.

## Graph Neural Network

network를 input으로 다루고, graph convolution, activation function, regularization 을 반복해서 새로운 노드나 새로운 관계나 그래프 자체를 새로 만들어 output으로 내놓게 된다.

## Node Embedding

가장 중요한 것은 **node Embedding**

**노드를 d차원의 embedding으로 매핑시키는 것**

**네트워크의 비슷한 node들은 유사한 vector로 표현되어 모여있을 수 있도록**

u와 v 노드는 embedding 혹은 encoding을 통해 embedding space에 z_u, z_v 벡터에 대응된다.

목표는 u와 v라는 노드가 있을 때 similarity를 높은 방향으로 embedding 하기이다.

이때, 유사도는 dot product로 측정한다.

node embedding에서 2개 주요 컴포넌트는 encoder, similarity function이다.

**Encoder**: 노드를 낮은 차원의 벡터로 매핑시켜주는 역할

**similarity function**: 어떻게 vector space에 있는 관계가 original network 관계에 매핑 되냐를 구체화

encoding을 위한 embedding table을 가장 간단하게는 아래와 같이 만들 수 있다.

(그림)

그래서 encoder 작업이 단지 embedding-lookup하는 것처럼 보일 수 있다.

한계점

- 노드 간에 파라미터를 공유하지 않는다.
  
  - CNN은 receptive field마다 파라미터를 공유했다.

- training할 때 보이지 않았던 노드에 대한 embedding은 생성할 수 없다.
  
  - 유저가 새로 가입했지만 학습이 되어 있지 않아 해당 node의 embedding table은 작성되어있지 않다. 따라서 embedding이 아예 불가능하다.

대신 DNN 사용해 encoding을 수행한다.

그래프 구조 기반의 multiple layers of non-linear transformations

여러 downstream task를 수행할 수 있다.

- node classification - 뒤에 classifier를 붙여 구현할 수 있다.

- link prediction - 유사도가 높으면 edge로 연결 가능성 높게 구현할 수 있다.

- community detection

- network similarity

## Application

### Node-Level: Protein Folding

단백질 구조를 아미노산 배열만 가지고 3D structure를 예측하는 문제이다.

spatial graph이다.

노드는 단백질 염기 서열이고 간선은 proximity btwn 아미노산들 (residues)을 나타낸다.

### Edge-Level: Recommendation System

유저는 아이템과 상호작용한다. 영화를 보고, 상품을 사고, 음악을 듣는다.

노드는 유저와 아이템이고 간선이 상호 작용을 나타낸다.

첫번째 방법

유저가 좋아할만한 아이템을 추천해주기 위해 그래프로 담긴 정보를 GNN을 거쳐 embedding 시키고 그 결과 새로운 edge로 예측하도록 한다.

두번째 방법

cake1과 cake2는 유사하고 cake1과 sweater는 덜 유사하도록 embedding 수행해 노드를 학습시킨다.

두 노드인 cake1과 cake2가 연관되었는지 edge로 예측한다.

### Graph-Level: Drug Discovery

신약 개발할 때 매우 활발히 사용한다.

항생제는 작은 분자 그래프이다. 노드는 원자, 간선은 화학 결합을 의미한다.

각 많은 그래프를 embedding 시켜 새로운 그래프를 만들었다. 이 새로운 그래프가 새로운 분자 구조를 의미하게 된다.
