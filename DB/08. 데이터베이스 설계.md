# 8장 데이터베이스 설계

## 01. 데이터베이스 설계 단계

![image-20210609202103222](C:\Users\Jueun\AppData\Roaming\Typora\typora-user-images\image-20210609202103222.png)

## 02. 요구 사항 분석

결과물: 요구 사항 명세서

주요 작업 

- 데이터베이스를 실제로 사용할 주요 사용자의 범위를 결정
- 사용자가 조직에서 수행하는 업무를 분석
- 면담, 설문 조사, 업무 관련 문서 분석 등의 방법을 이용해 요구 사항 수집
- 수집된 요구 사항에 대한 분석 결과를 요구 사항 명세서로 작성

예시: 인터넷으로 회원들에게 상품을 판매하는 한빛 마트의 데이터베이스 개발

![image-20210609202246005](C:\Users\Jueun\AppData\Roaming\Typora\typora-user-images\image-20210609202246005.png)

## 03. 개념적 설계

**목적**

- **DBMS에 독립적**인 개념적 스키마 설계
- 요구 사항 분석 결과물을 개념적 데이터 모델을 이용해 개념적 구조로 표현
- 개념적 모델링 – 일반적으로 E-R 모델을 많이 이용

**결과물** 

- 개념적 스키마 : E-R 다이어그램 또는 IE 표기법

**주요 작업** 

- 요구 사항 분석 결과를 기반으로 중요한 개체를 추출하고 개체 간의 관계를 결정하여 E-R 다이어그램으로 표현

**작업과정**

- STEP 1) 개체 추출, 각 개체의 주요 속성과 키 속성 선별 
- STEP 2) 개체 간의 관계 결정 
- STEP 3) E-R 다이어그램 또는 IE 표기법으로 표현

### STEP 1) 개체 추출, 각 개체의 주요 속성과 키 속성 선별 

**개체** : 저장할 만한 가치가 있는 중요 데이터를 가진 사람이나 사물 등 

**개체 추출 방법** 

- 요구 사항 문장에서 업무와 관련이 깊은 의미 있는 **명사**를 찾아라! 
  - 업무와 관련이 적은 일반적이고 광범위한 의미의 명사는 제외 (소거법)
  - 의미가 같은 명사가 여러 개일 경우는 대표 명사 하나만 선택
- 찾아낸 명사를 **개체와 속성으로 분류**하라!

**예시**

![image-20210609202827134](C:\Users\Jueun\AppData\Roaming\Typora\typora-user-images\image-20210609202827134.png)

### STEP 2) 개체 간의 관계 결정 

**관계** : 개체 간의 의미 있는 연관성

**관계 추출 방법** 

- 요구 사항 문장에서 개체 간의 연관성을 **의미 있게 표현한 동사**를 찾아라! 
  - 의미가 같은 동사가 여러 개일 경우는 대표 동사 하나만 선택 
- 찾아낸 관계에 대해 **매핑 카디널리티**와 **참여 특성**, (종속성)을 결정하라! 
  - 매핑 카디널리티 : 일대일(1:1), 일대다(1:n), 다대다(n:m) 
  - 참여 특성 : 필수적 참여 / 선택적 참여

**예시**

```
⑧ 각 상품은 한 제조업체가 공급하고, 제조업체 하나는 여러 상품을 공급할 수 있다.
⑨ 제조업체가 상품을 공급하면 공급일자와 공급량 정보를 유지해야 한다.
```

- **관계: 공급**

  - “제조업체” 개체와 상품” 개체가 맺는 관계, 일대다(1:n) 관계

  - “상품” 개체는 관계에 필수적으로 참여 / “제조업체” 개체는 관계에 선택적으로 참여

    왜? 제조업체는 **공급**을 할수도 있고 안할 수 있는 선택적 개체이지만 제조업자가 공급했을 때 상품은 필수적으로 공급됨. 선택할 수 없음.

- “공급” 관계의 속성 : 공급일자, 공급량

**예시 결과**

![image-20210609203813305](C:\Users\Jueun\AppData\Roaming\Typora\typora-user-images\image-20210609203813305.png)

### STEP 3-1) E-R 다이어그램으로 표현

![image-20210609202500425](C:\Users\Jueun\AppData\Roaming\Typora\typora-user-images\image-20210609202500425.png)

###  STEP 3-2) IE 표기법으로 표현

goodnote 참고

## 04. 논리적 설계

**목적** 

- **DBMS에 적합한** 논리적 스키마 설계
- 개념적 스키마를 논리적 데이터 모델을 이용해 논리적 구조로 표현
- 논리적 모델링(데이터 모델링) - 일반적으로 관계 데이터 모델을 많이 이용

**결과물** 

- 논리적 스키마 : 릴레이션 스키마 

**주요 작업** 

- 개념적 설계 단계의 결과물인 E-R 다이어그램을 릴레이션 스키마로 변환
- 릴레이션 스키마로 변환 후 속성의 데이터 타입, 길이, 널 값 허용 여부, 기본 값, 제약조건 등을 세부적으로 결정하고 결과를 문서화시킴

**E-R 다이어그램을 릴레이션 스키마로 변환하는 규칙** 

(변환 규칙을 순서대로 적용하되, 해당되지 않는 규칙은 제외함)

- 규칙 1 : 모든 개체는 릴레이션으로 변환한다.
- 규칙 2 : 다대다(n:m) 관계는 릴레이션으로 변환한다. 
- 규칙 3 : 일대다(1:n) 관계는 외래키로 표현한다.
- 규칙 4 : 일대일(1:1) 관계는 외래키로 표현한다.
- 규칙 5 : 다중 값 속성은 릴레이션으로 변환한다. 



### 규칙 1 : 모든 개체는 릴레이션으로 변환한다

![image-20210609205616610](C:\Users\Jueun\AppData\Roaming\Typora\typora-user-images\image-20210609205616610.png)

E-R 다이어그램의 각 개체를 하나의 릴레이션으로 변환

- 개체의 이름 → 릴레이션 이름
- 개체의 속성 → 릴레이션의 속성 
- 개체의 키 속성 → 릴레이션의 기본키 
- 개체의 속성이 **복합 속성인 경우**에는 복합 속성을 구성하고 있는 **단순 속성만** 릴레이션의 속성으로 변환
  - ex) 주소 - 우편주소, 기본주소, 상세주소의 경우 구체적인 3개를 속성으로 변환

### 규칙 2 : 다대다(n:m) 관계는 릴레이션으로 변환한다

![image-20210609205550352](C:\Users\Jueun\AppData\Roaming\Typora\typora-user-images\image-20210609205550352.png)

 E-R 다이어그램의 다대다 관계를 하나의 릴레이션으로 변환 

- 관계의 이름 → 릴레이션 이름 
- 관계의 속성 → 릴레이션의 속성
- 관계에 참여하는 개체를 규칙 1에 따라 릴레이션으로 변환한 후 이 릴레이션의 기본키를 관계 릴레이션에 포함시켜 외래키로 지정하고, 외래키들을 조합하여 관계 릴레이션의 기본키로 지정 (하지만 관계 개체의 기본키를 따로 만드는 것이 더욱 일반적이다)

### 규칙 3 : 일대다(1:n) 관계는 외래키로 표현한다

E-R 다이어그램의 일대다 관계는 외래키로만 표현 

- **규칙 3-1: 일반적인 일대다 관계는 외래키로 표현한다.**

  ![image-20210609205638991](C:\Users\Jueun\AppData\Roaming\Typora\typora-user-images\image-20210609205638991.png)

  - 일대다(1:n) 관계에서 1측 개체 릴레이션의 기본키를 **n측 개체 릴레이션에** 포함시켜 **외래키로 지정**
  - 관계의 속성들도 n측 개체 릴레이션에 포함시킴

- **규칙 3-2: 약한 개체가 참여하는 일대다 관계는 외래키를 포함해서 기본키로 지정한다.**

  ![image-20210609205712271](C:\Users\Jueun\AppData\Roaming\Typora\typora-user-images\image-20210609205712271.png)

  - 일대다(1:n) 관계에서 1측 개체 릴레이션의 기본키를 n측 개체 릴레이션에 포함시켜 외래키로 지정
  - 관계의 속성들도 n측 개체 릴레이션에 포함시킴
  - n측 개체 릴레이션은 **외래키를 포함하여 기본키를 지정**함 - 꼭꼭꼭!
    - **약한 개체는 강한 개체에 따라 존재 여부가 결정되므로** 강한 개체의 기본키를 이용해 식별해야 함

### 규칙 4 : 일대일(1:1) 관계는 외래키로 표현한다

 E-R 다이어그램의 일대일 관계는 외래키로만 표현 

- **규칙 4-1: 일반적인 일대일 관계는 외래키를 서로 주고받는다.**

  ![image-20210609210257982](C:\Users\Jueun\AppData\Roaming\Typora\typora-user-images\image-20210609210257982.png)

  - 관계에 참여하는 개체 릴레이션들이 서로의 기본키를 주고받아 외래키로 지정
  - 관계의 속성들도 모든 개체 릴레이션에 포함시킴 
  - 불필요한 **데이터 중복**이 발생할 수 있음

- **규칙 4-2: 일대일 관계에 필수적으로 참여하는 개체의 릴레이션만 외래키를 받는다.**

  ![image-20210609210227188](C:\Users\Jueun\AppData\Roaming\Typora\typora-user-images\image-20210609210227188.png)

  - 관계에 필수적으로 참여하는 개체 릴레이션에만 외래키를 포함시킴
  - 관계의 속성들은 관계에 필수적으로 참여하는 개체 릴레이션에 포함시킴

- **규칙 4-3: 모든 개체가 일대일 관계에 필수적으로 참여하면 릴레이션 하나로 합친다.**

  - 관계에 참여하는 개체 릴레이션들을 하나의 릴레이션으로 합쳐서 표현
  - 관계의 이름을 릴레이션 이름으로 사용하고, 관계에 참여하는 두 개체의 속성들을 관계 릴레이션에 모두 포함시킴
  - 두 개체 릴레이션의 키 속성을 조합하여 관계 릴레이션의 기본키로 지정 (but 새로운 키를 기본키로 지정하는 것이 더 일반적임.)

### 규칙 5 : 다중 값 속성은 릴레이션으로 변환한다 -> 이거 별

![image-20210609210510617](C:\Users\Jueun\AppData\Roaming\Typora\typora-user-images\image-20210609210510617.png)

 E-R 다이어그램의 다중 값 속성은 독립적인 릴레이션으로 변환

- 다중 값 속성과 함께 그 속성을 가지고 있던 개체 릴레이션의 기본키를 외래키로 가져와 새로운 릴레이션에 포함시킴
- 새로운 릴레이션의 기본키는 다중 값 속성과 외래키를 조합하여 지정

### 기타 고려 사항

**모든 관계를 독립적인 릴레이션으로 변환할 수 있다.**

- 속성이 많은 관계는 유형에 상관없이 릴레이션으로의 변환을 고려할 수 있음

**개체가 자기 자신과 관계를 맺는 순환 관계도 기본 규칙을 그대로 적용한다.**

![image-20210609211155587](C:\Users\Jueun\AppData\Roaming\Typora\typora-user-images\image-20210609211155587.png)

**예시 결과**

![image-20210609204842664](C:\Users\Jueun\AppData\Roaming\Typora\typora-user-images\image-20210609204842664.png)

### 테이블 명세서 작성

- 테이블 명세서 : 릴레이션 스키마에 대한 설계 정보를 기술한 문서
- 릴레이션 스키마 변환 후 속성의 데이터 타입과 길이, 널 값 허용 여부, 기본값, 제약조건 등을 세부적으로 결정하고 문서화시킴

![image-20210609204943529](C:\Users\Jueun\AppData\Roaming\Typora\typora-user-images\image-20210609204943529.png)

## 05. 물리적 설계와 구현

### **설계 4 단계** : 물리적 설계

하드웨어나 운영체제의 특성을 고려하여 필요한 인덱스 구조나 내부 저장 구조 등에 대한 물리적인 구조를 설계

### 설계 5 단계 : 구현

SQL로 작성한 명령문을 DBMS에서 실행하여 데이터베이스를 실제로 생성

